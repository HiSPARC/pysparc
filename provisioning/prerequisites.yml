---
- name: Install PySPARC prerequisites (system packages)
  apt: name={{ item }} state=present
  sudo: yes
  with_items:
    - python-dev
    - python-setuptools
    - python-pip
    - python-tables
    - python-flask
    - redis-server
    - python-redis
    - libftdi-dev
    - hdf5-tools

- name: Install PySPARC prerequisites (python packages)
  pip: name={{ item }} state=present
  sudo: yes
  with_items:
    - mock
    - pylibftdi
    - atom
    - lazy
    - requests>=2.4.1

- name: Make sure memory can be overcommitted (for Redis)
  lineinfile: dest=/etc/sysctl.conf state=present regexp=^vm.overcommit_memory
              line=vm.overcommit_memory=1
  register: result
  sudo: yes

- name: Reload kernel parameters
  service: name=procps state=restarted
  when: result|changed
  sudo: yes
